version: 2.1
executors:
  node-executor:
    docker:
      - image: circleci/node:10.15
    working_directory: ~/repo

jobs:
  print:
    executor: node-executor
    environment:
      - GIT_BASE_REVISION: << pipeline.git.base_revision >>
      - GIT_CURRENT_REVISION: << pipeline.git.revision >>
    steps:
      - checkout
      - run: echo "$GIT_BASE_REVISION"
      - run: echo "$GIT_CURRENT_REVISION"
      - run: git remote -v
      - run: echo $(git branch --list -a)
      - run: |
          BUMP_VERSION_COMMITS=$(git log "$GIT_BASE_REVISION".."$GIT_CURRENT_REVISION" --pretty=format:%h:%s | grep "chore")
          echo $BUMP_VERSION_COMMITS
          echo "export BUMP_VERSION_COMMITS=${BUMP_VERSION_COMMITS}" >> $BASH_ENV
      - run: echo $BUMP_VERSION_COMMITS

workflows:
  version: 2.1
  print_infos:
    jobs:
      - print:
          filters:
            branches:
              only:
                - ci-dev
